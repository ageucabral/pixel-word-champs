
<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Letra Arena - Ca√ßa Palavras</title>
    <meta name="description" content="O melhor jogo de ca√ßa-palavras do Brasil! Participe de desafios di√°rios e ganhe pr√™mios reais." />
    <meta name="author" content="Letra Arena" />
    <meta name="theme-color" content="#8B5CF6" />

    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Letra Arena">

    <meta property="og:title" content="Letra Arena - Ca√ßa Palavras" />
    <meta property="og:description" content="O melhor jogo de ca√ßa-palavras do Brasil! Participe de desafios di√°rios e ganhe pr√™mios reais." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@letraarena" />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <style>
      /* Prote√ß√£o anti-zoom e scroll inteligente - VERS√ÉO FORTALECIDA */
      * {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
        /* Prevenir todos os tipos de zoom */
        touch-action: manipulation;
        -webkit-text-size-adjust: 100%;
        -ms-text-size-adjust: 100%;
        text-size-adjust: 100%;
      }
      
      /* Permitir sele√ß√£o para inputs essenciais */
      input, textarea, [contenteditable] {
        -webkit-user-select: text;
        -moz-user-select: text;
        -ms-user-select: text;
        user-select: text;
        touch-action: manipulation;
        font-size: 16px;
      }
      
      /* Configura√ß√£o para scroll protegido com detec√ß√£o rigorosa */
      html, body {
        overflow-x: hidden;
        overflow-y: auto;
        overscroll-behavior: contain;
        height: 100%;
        margin: 0;
        padding: 0;
        /* Prote√ß√£o adicional */
        -webkit-overflow-scrolling: touch;
        scroll-behavior: smooth;
      }
      
      #root {
        width: 100%;
        min-height: 100vh;
        overflow-x: hidden;
        overflow-y: auto;
        overscroll-behavior: contain;
        -webkit-overflow-scrolling: touch;
      }

      /* Prote√ß√£o m√°xima para √°reas do jogo */
      .game-board-area {
        touch-action: none !important;
        overscroll-behavior: contain !important;
        overflow: hidden !important;
        -webkit-overflow-scrolling: auto !important;
        /* Garantir que n√£o h√° scroll interno */
        max-width: 100vw;
        box-sizing: border-box;
      }
    </style>
  </head>

  <body>
    <div id="root"></div>
    
    <!-- Script para prote√ß√£o anti-zoom e controle inteligente de extremidades -->
    <script>
      // SISTEMA DE PROTE√á√ÉO FORTALECIDO
      
      // Prevenir zoom program√°tico
      document.addEventListener('gesturestart', function(e) {
        e.preventDefault();
      });
      
      document.addEventListener('gesturechange', function(e) {
        e.preventDefault();
      });
      
      document.addEventListener('gestureend', function(e) {
        e.preventDefault();
      });
      
      // Prevenir zoom por Ctrl+scroll no desktop
      document.addEventListener('wheel', function(e) {
        if (e.ctrlKey) {
          e.preventDefault();
        }
      }, { passive: false });
      
      // SISTEMA DE DETEC√á√ÉO DE EXTREMIDADES INTELIGENTE
      let isAtTop = true;
      let isAtBottom = false;
      let touchStartY = 0;
      let touchStartX = 0;
      let isInGameArea = false;
      let lastScrollY = 0;
      let scrollDirection = 'none';
      
      // Detec√ß√£o melhorada de posi√ß√£o do scroll
      function updateScrollPosition() {
        const currentScrollY = window.scrollY;
        const maxScrollY = document.documentElement.scrollHeight - window.innerHeight;
        
        isAtTop = currentScrollY <= 5; // Margem de 5px para o topo
        isAtBottom = currentScrollY >= maxScrollY - 5; // Margem de 5px para o fundo
        
        // Detectar dire√ß√£o do scroll
        if (currentScrollY > lastScrollY) {
          scrollDirection = 'down';
        } else if (currentScrollY < lastScrollY) {
          scrollDirection = 'up';
        }
        
        lastScrollY = currentScrollY;
      }
      
      // Monitorar scroll com requestAnimationFrame para performance
      let scrollUpdateScheduled = false;
      function scheduleScrollUpdate() {
        if (!scrollUpdateScheduled) {
          scrollUpdateScheduled = true;
          requestAnimationFrame(() => {
            updateScrollPosition();
            scrollUpdateScheduled = false;
          });
        }
      }
      
      window.addEventListener('scroll', scheduleScrollUpdate);
      updateScrollPosition();
      
      // DETEC√á√ÉO DE √ÅREA DO JOGO MELHORADA
      function detectGameArea(element) {
        return element && (
          element.classList.contains('game-board-area') ||
          element.classList.contains('game-cell') ||
          element.closest('.game-board-area') ||
          element.closest('[data-cell]')
        );
      }
      
      // CONTROLE DE TOUCH INTELIGENTE COM PROTE√á√ÉO FORTALECIDA
      let touchEventThrottled = false;
      
      document.addEventListener('touchstart', function(e) {
        if (touchEventThrottled) return;
        
        const touch = e.touches[0];
        touchStartY = touch.clientY;
        touchStartX = touch.clientX;
        isInGameArea = detectGameArea(e.target);
        
        // Prote√ß√£o rigorosa nas bordas laterais (aumentada para 50px)
        const screenWidth = window.innerWidth;
        const edgeBuffer = 50;
        
        if (touch.clientX < edgeBuffer || touch.clientX > screenWidth - edgeBuffer) {
          e.preventDefault();
          return;
        }
        
        // Prote√ß√£o espec√≠fica para √°rea do jogo
        if (isInGameArea) {
          // Permitir apenas movimento m√≠nimo para sele√ß√£o de palavras
          return;
        }
      }, { passive: false });
      
      document.addEventListener('touchmove', function(e) {
        if (touchEventThrottled) return;
        
        // Throttling para performance
        touchEventThrottled = true;
        requestAnimationFrame(() => {
          touchEventThrottled = false;
        });
        
        const touch = e.touches[0];
        const touchY = touch.clientY;
        const touchX = touch.clientX;
        const touchDeltaY = touchY - touchStartY;
        const touchDeltaX = touchX - touchStartX;
        
        // PROTE√á√ÉO M√ÅXIMA PARA √ÅREA DO JOGO
        if (isInGameArea) {
          // Prevenir qualquer scroll durante sele√ß√£o de palavras
          if (Math.abs(touchDeltaX) > 30 || Math.abs(touchDeltaY) > 30) {
            e.preventDefault();
            return;
          }
        }
        
        // Prote√ß√£o nas bordas com detec√ß√£o inteligente
        const screenWidth = window.innerWidth;
        const screenHeight = window.innerHeight;
        const edgeBuffer = 50;
        
        // Bordas laterais - prevenir swipe para navega√ß√£o
        if (touch.clientX < edgeBuffer || touch.clientX > screenWidth - edgeBuffer) {
          if (Math.abs(touchDeltaX) > Math.abs(touchDeltaY)) {
            e.preventDefault();
            return;
          }
        }
        
        // Borda superior - prevenir pull-to-refresh
        if (isAtTop && touchDeltaY > 0 && touch.clientY < screenHeight * 0.3) {
          e.preventDefault();
          return;
        }
        
        // Borda inferior - prevenir bounce
        if (isAtBottom && touchDeltaY < 0 && touch.clientY > screenHeight * 0.7) {
          e.preventDefault();
          return;
        }
        
      }, { passive: false });
      
      // SISTEMA DE FALLBACK PARA DETEC√á√ÉO DE MOVIMENTO INDESEJADO
      let lastKnownScrollPosition = 0;
      let undesiredMovementDetected = false;
      
      function detectUndesiredMovement() {
        const currentScroll = window.scrollY;
        const scrollDifference = Math.abs(currentScroll - lastKnownScrollPosition);
        
        // Se houve movimento significativo durante intera√ß√£o com o jogo
        if (isInGameArea && scrollDifference > 10) {
          undesiredMovementDetected = true;
          
          // Restaurar posi√ß√£o anterior
          window.scrollTo(0, lastKnownScrollPosition);
          
          // Log para monitoramento
          console.log('üõ°Ô∏è Movimento indesejado detectado e corrigido', {
            scrollDifference,
            currentScroll,
            lastKnownScrollPosition,
            timestamp: new Date().toISOString()
          });
        }
        
        // Atualizar posi√ß√£o conhecida apenas se n√£o houver intera√ß√£o com o jogo
        if (!isInGameArea && !undesiredMovementDetected) {
          lastKnownScrollPosition = currentScroll;
        }
        
        // Resetar flag ap√≥s corre√ß√£o
        setTimeout(() => {
          undesiredMovementDetected = false;
        }, 100);
      }
      
      // Monitorar movimento indesejado
      window.addEventListener('scroll', detectUndesiredMovement);
      
      // LOG PARA MONITORAMENTO EM PRODU√á√ÉO
      const logProtectionEvent = (event, details) => {
        console.log(`üõ°Ô∏è Prote√ß√£o ativada: ${event}`, {
          ...details,
          timestamp: new Date().toISOString(),
          userAgent: navigator.userAgent.substring(0, 50),
          screenSize: `${window.innerWidth}x${window.innerHeight}`
        });
      };
      
      // Inicializar sistema de prote√ß√£o
      console.log('üõ°Ô∏è Sistema de prote√ß√£o anti-zoom e anti-scroll inicializado', {
        version: '2.0',
        features: ['anti-zoom', 'edge-protection', 'game-area-protection', 'fallback-system'],
        edgeBuffer: '50px',
        timestamp: new Date().toISOString()
      });
    </script>
    
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
